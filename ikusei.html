<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>育成ゲーム</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 0; }
        canvas { display: block; margin: 0 auto; background: #f0f0f0; }
        #scoreboard { text-align: center; margin: 10px; }
        #controls { text-align: center; margin: 10px; }
    </style>
</head>
<body>
    <div id="scoreboard">エネルギー: 100 | レベル: 1</div>
    <div id="controls">
        <button onclick="feedCharacter()">食べ物をあげる</button>
        <button onclick="trainCharacter()">トレーニングする</button>
    </div>
    <canvas id="gameCanvas" width="800" height="600"></canvas>
    <audio id="backgroundMusic" src="background.mp3" loop></audio>
    <audio id="collisionSound" src="collision.mp3"></audio>
    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');

        // 画像のロード
        const images = {
            vista: new Image(),
            longhorn: new Image(),
            food: new Image()
        };
        images.vista.src = 'img/vista.png'; // 正しいパスを指定してください
        images.longhorn.src = 'img/longhorn.png'; // 正しいパスを指定してください
        images.food.src = 'img/food.png'; // 正しいパスを指定してください

        const backgroundMusic = document.getElementById('backgroundMusic');
        const collisionSound = document.getElementById('collisionSound');

        let characterVista = {
            x: 100,
            y: 100,
            width: 30,
            height: 30,
            image: images.vista,
            dx: 1.5,
            dy: 1.5,
            energy: 100,
            level: 1
        };

        let characterLonghorn = {
            x: 200,
            y: 200,
            width: 50,
            height: 50,
            image: images.longhorn,
            dx: 2,
            dy: 2,
            energy: 100,
            level: 1
        };

        const foodItems = [
            { x: 400, y: 150, width: 20, height: 20 },
            { x: 600, y: 300, width: 20, height: 20 }
        ];

        function drawCharacter(character) {
            ctx.drawImage(character.image, character.x, character.y, character.width, character.height);
        }

        function drawHouse() {
            // 家の描画
            ctx.strokeStyle = 'black';
            ctx.lineWidth = 3;
            ctx.strokeRect(300, 400, 100, 100); // 家の本体
            ctx.fillStyle = '#f5deb3'; 
            ctx.fillRect(300, 400, 100, 100); // 家の中のベージュ部分

            // 屋根の描画
            ctx.beginPath();
            ctx.moveTo(290, 400);
            ctx.lineTo(350, 350);
            ctx.lineTo(410, 400);
            ctx.closePath();
            ctx.stroke();
            ctx.fillStyle = '#d2691e';
            ctx.fill();
        }

        function drawObstacles() {
            const obstacles = [
                { x: 200, y: 200, width: 50, height: 50, color: 'red' },
                { x: 400, y: 300, width: 50, height: 50, color: 'green' }
            ];
            obstacles.forEach(obstacle => {
                ctx.fillStyle = obstacle.color;
                ctx.fillRect(obstacle.x, obstacle.y, obstacle.width, obstacle.height);
            });
        }

        function drawFood() {
            foodItems.forEach(food => {
                ctx.drawImage(images.food, food.x, food.y, food.width, food.height);
            });
        }

        function updateDisplay() {
            document.getElementById('scoreboard').textContent = `エネルギー: ${characterVista.energy} | レベル: ${characterVista.level}`;
        }

        function feedCharacter() {
            characterVista.energy += 10;
            characterLonghorn.energy += 10;
            if (characterVista.energy > 100) characterVista.energy = 100;
            if (characterLonghorn.energy > 100) characterLonghorn.energy = 100;
            updateDisplay();
        }

        function trainCharacter() {
            if (characterVista.energy > 0) {
                characterVista.energy -= 10;
                characterVista.level += 1;
            }
            if (characterLonghorn.energy > 0) {
                characterLonghorn.energy -= 10;
                characterLonghorn.level += 1;
            }
            updateDisplay();
        }

        function checkCollision(character) {
            foodItems.forEach((food, index) => {
                if (character.x < food.x + food.width &&
                    character.x + character.width > food.x &&
                    character.y < food.y + food.height &&
                    character.y + character.height > food.y) {
                        character.energy += 20;
                        if (character.energy > 100) character.energy = 100;
                        foodItems.splice(index, 1);
                        updateDisplay();
                }
            });
        }

        function moveCharacter(character) {
            character.x += character.dx;
            character.y += character.dy;

            if (character.x < 0 || character.x + character.width > canvas.width) {
                character.dx *= -1;
            }
            if (character.y < 0 || character.y + character.height > canvas.height) {
                character.dy *= -1;
            }
        }

        function gameLoop() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            drawHouse();
            drawObstacles();
            drawFood();
            moveCharacter(characterVista);
            moveCharacter(characterLonghorn);
            drawCharacter(characterVista);
            drawCharacter(characterLonghorn);
            checkCollision(characterVista);
            checkCollision(characterLonghorn);
            requestAnimationFrame(gameLoop);
        }

        images.vista.onload = () => {
            images.longhorn.onload = () => {
                images.food.onload = () => {
                    backgroundMusic.play();
                    gameLoop();
                };
            };
        };
    </script>
</body>
</html>
